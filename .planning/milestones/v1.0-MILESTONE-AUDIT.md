---
milestone: v1.0
audited: 2026-02-25T23:00:00Z
status: tech_debt
scores:
  requirements: 26/26
  phases: 8/8
  integration: 18/21
  flows: 5/6
gaps:
  requirements: []
  integration:
    - "README Helm section uses wrong label selector (app=claude-agent instead of app=claude-in-a-box)"
  flows: []
tech_debt:
  - phase: 02-entrypoint-authentication
    items:
      - "readiness.sh shipped in image but never wired into any K8s manifest or Helm template — all manifests use healthcheck.sh for both liveness and readiness"
  - phase: 01-container-foundation
    items:
      - "docker/.dockerignore not applied — Docker looks for .dockerignore at build context root (./) not alongside Dockerfile; .git and .planning sent as build context on every build"
  - phase: 05-integration-testing
    items:
      - "BATS integration tests (35 tests) not wired into CI pipeline — only run manually via make test"
      - "Dev and test KIND clusters share name claude-in-a-box — running make test-setup after make bootstrap skips Calico install, causing NetworkPolicy tests to produce false positives"
  - phase: 08-documentation-release
    items:
      - "README line 243 Helm verification command uses app=claude-agent but Helm pods carry label app=claude-in-a-box"
---

# Milestone v1.0 Audit Report

**Milestone:** v1.0 MVP
**Audited:** 2026-02-25
**Status:** tech_debt (no critical blockers; 5 tech debt items across 4 phases)

---

## Phase Verification Summary

| Phase | Status | Score | Critical Gaps | Tech Debt |
|-------|--------|-------|---------------|-----------|
| 1. Container Foundation | passed | 5/5 | 0 | 1 (dockerignore) |
| 2. Entrypoint & Authentication | passed | 5/5 | 0 | 1 (readiness.sh) |
| 3. Local Development Environment | human_needed | 4/4 static | 0 | 0 |
| 4. Kubernetes Manifests & RBAC | passed | 5/5 | 0 | 0 |
| 5. Integration Testing | passed | 5/5 | 0 | 2 (CI, cluster name) |
| 6. Intelligence Layer | passed | 7/7 | 0 | 0 |
| 7. Production Packaging | passed | 4/4 | 0 | 0 |
| 8. Documentation & Release | human_needed | 4/4 static | 0 | 1 (Helm label) |

**Totals:** 8/8 phases verified (6 passed, 2 human_needed for runtime checks)

---

## Requirements Coverage

All 26 v1 requirements are covered by completed phases. Phase verifications confirm satisfaction of all mapped requirements.

| Requirement | Phase | Verification | Status |
|-------------|-------|-------------|--------|
| IMG-01 | Phase 1 | passed | SATISFIED |
| IMG-02 | Phase 1 | passed | SATISFIED |
| IMG-03 | Phase 1 | passed | SATISFIED |
| IMG-04 | Phase 1 | passed | SATISFIED |
| IMG-05 | Phase 1 | passed | SATISFIED |
| IMG-06 | Phase 7 | passed | SATISFIED |
| ENT-01 | Phase 2 | passed | SATISFIED |
| ENT-02 | Phase 2 | passed | SATISFIED |
| ENT-03 | Phase 2 | passed | SATISFIED |
| ENT-04 | Phase 2 | passed | SATISFIED |
| ENT-05 | Phase 2 | passed | SATISFIED |
| K8S-01 | Phase 4 | passed | SATISFIED |
| K8S-02 | Phase 4 | passed | SATISFIED |
| K8S-03 | Phase 4 | passed | SATISFIED |
| K8S-04 | Phase 4 | passed | SATISFIED |
| K8S-05 | Phase 4 | passed | SATISFIED |
| K8S-06 | Phase 7 | passed | SATISFIED |
| DEV-01 | Phase 3 | human_needed | SATISFIED (static) |
| DEV-02 | Phase 3 | human_needed | SATISFIED (static) |
| DEV-03 | Phase 3 | human_needed | SATISFIED (static) |
| DEV-04 | Phase 5 | passed | SATISFIED |
| DEV-05 | Phase 3 | human_needed | SATISFIED (static) |
| INT-01 | Phase 6 | passed | SATISFIED |
| INT-02 | Phase 6 | passed | SATISFIED |
| DOC-01 | Phase 8 | human_needed | SATISFIED (static) |
| DOC-02 | Phase 6 | passed | SATISFIED |

**Score:** 26/26 requirements satisfied (21 automated, 5 pending human runtime verification)

---

## Cross-Phase Integration

**Verified connections:** 18 of 21 cross-phase wiring points confirmed

### Wired Correctly

- Dockerfile multi-stage layering (Phase 1 → 2 → 6)
- Entrypoint flow: tini → entrypoint.sh → skills staging → CLAUDE.md gen → exec claude
- PVC mount path consistency (/app/.claude) across all manifests and Compose
- Makefile → k8s/base/ manifests (K8S_MANIFESTS variable)
- Makefile → k8s/overlays/rbac-operator.yaml (OPERATOR_RBAC variable)
- BATS tests → Phase 4 manifests (RBAC, NetworkPolicy, StatefulSet)
- BATS tests → Phase 1 verify-tools.sh (exec_in_pod)
- Helm RBAC rules match raw manifests (14 resources, same verbs)
- Helm NetworkPolicy matches raw manifests (DNS, HTTPS, K8s API)
- MCP config → image → Claude Code reads at startup
- Skills → image → entrypoint stages to PVC → Claude Code loads
- CI → Dockerfile build + Trivy + SBOM + Helm lint + golden tests
- Auth flow: token env var → entrypoint validation → exec claude

### Issues Found

1. **readiness.sh orphaned** — Built into image (Phase 2) but no manifest or Helm template references it. All probes use healthcheck.sh (pgrep-based). Auth-aware readiness was deferred in Phase 3 and never revisited.

2. **docker/.dockerignore mislocated** — Exists at `docker/.dockerignore` but build context is `.` (repo root). Docker looks for `./.dockerignore` which doesn't exist. Build context includes .git and .planning.

3. **BATS tests not in CI** — Phase 5 delivered 35 integration tests. Phase 7 delivered CI. The connection was never made. No RBAC, networking, or persistence tests run automatically on push/PR.

---

## E2E Flow Verification

| Flow | Status | Issue |
|------|--------|-------|
| KIND Local Dev (`make bootstrap`) | COMPLETE | — |
| Docker Compose Standalone (`docker compose up`) | COMPLETE | — |
| Helm Production (`helm install`) | COMPLETE | README verification command wrong label |
| Integration Tests (`make test-setup && make test`) | DEGRADED | Cluster name collision skips Calico if dev cluster exists |
| Authentication Flow | COMPLETE | — |
| Skills + MCP Flow | COMPLETE | — |

**Score:** 5/6 flows complete, 1 degraded

---

## Tech Debt Summary

### 1. readiness.sh Orphaned (Phase 2)
- **What:** `readiness.sh` uses `claude auth status` for auth-aware readiness. It's in the image but unused.
- **Impact:** Low for dev. Material for production remote-control mode — pod marked Ready before auth completes.
- **Fix:** Wire `readiness.sh` into StatefulSet readiness probe and Helm values.

### 2. docker/.dockerignore Mislocated (Phase 1)
- **What:** `.dockerignore` at `docker/.dockerignore` instead of repo root `./.dockerignore`.
- **Impact:** Larger build context (`.git`, `.planning` transferred to daemon). No functional impact.
- **Fix:** Move to `./.dockerignore` or rename to `docker/Dockerfile.dockerignore`.

### 3. BATS Tests Not in CI (Phase 5/7)
- **What:** 35 integration tests exist but are manual-only. CI does not run them.
- **Impact:** RBAC, networking, and persistence regressions not caught automatically.
- **Fix:** Add CI job with KIND cluster + Calico for integration tests.

### 4. KIND Cluster Name Collision (Phase 5)
- **What:** `kind/cluster.yaml` and `kind/cluster-test.yaml` both use name `claude-in-a-box`.
- **Impact:** `make test-setup` after `make bootstrap` skips cluster creation and Calico install.
- **Fix:** Rename test cluster to `claude-in-a-box-test`.

### 5. README Helm Label Mismatch (Phase 8)
- **What:** README line 243 uses `kubectl get pods -l app=claude-agent` for Helm verification. Helm pods carry `app=claude-in-a-box`.
- **Impact:** Users following Helm quickstart get empty output from verification command.
- **Fix:** Change to `kubectl get pods -l app=claude-in-a-box` or use pod name `claude-agent-0`.

**Total:** 5 items across 4 phases. No critical blockers.

---

## REQUIREMENTS.md Checkbox Discrepancy

REQUIREMENTS.md has 5 requirements still marked `[ ]` (DEV-01, DEV-02, DEV-03, DEV-05, DOC-01) despite their owning phases being complete with verified artifacts. This is a tracking issue in REQUIREMENTS.md — the actual implementations exist and pass verification. These should be marked `[x]` during milestone completion.

---

## Conclusion

Milestone v1.0 is ready for completion. All 26 requirements are satisfied by implemented code. All 8 phases pass verification (6 automated, 2 need human runtime checks). Five tech debt items are documented for tracking in the next milestone. No critical blockers exist.

---

*Audited: 2026-02-25T23:00:00Z*
*Auditor: Claude (milestone-audit orchestrator + gsd-integration-checker)*
