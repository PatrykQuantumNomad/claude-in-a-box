---
import DocsLayout from "../../layouts/DocsLayout.astro";
import DiagramBlock from "../../components/ui/DiagramBlock.astro";
import TerminalBlock from "../../components/ui/TerminalBlock.astro";
---

<DocsLayout title="Claude Code & Remote Connect | RemoteKube" description="What Claude Code is, how Remote Connect works, and how RemoteKube deploys Claude Code inside Kubernetes for phone/browser access." activeSlug="claude-code">
  <h1 class="text-3xl md:text-4xl font-bold mb-6">
    <span class="gradient-text">Claude Code & Remote Connect</span>
  </h1>

  <!-- Linux Notice -->
  <div class="glass-card rounded-xl p-6 my-6 border border-yellow-500/30">
    <p class="text-text-secondary text-sm mb-0">
      <strong>Coming Soon on Linux:</strong> Remote Control is currently only available on macOS. The Linux native binary does not yet support `claude remote-control` due to a server-side feature gate. For now, use <strong>interactive mode</strong> with <code>kubectl attach</code> and the Kubernetes MCP tools. This page documents the architecture for when Linux support is enabled.
    </p>
  </div>

  <!-- Overview -->
  <h2 id="overview">Overview</h2>
  <p class="text-text-secondary">
    Claude Code is Anthropic's official CLI for Claude. It runs as a persistent process inside a terminal, maintaining full session state and project context across interactions. Unlike chat-based interfaces, Claude Code has direct tool access -- it can read and write files, execute bash commands, fetch web content, and work with MCP servers -- enabling it to operate autonomously on complex coding and infrastructure tasks.
  </p>
  <p class="text-text-secondary">
    Because Claude Code runs as a long-lived process rather than a stateless request/response cycle, it accumulates context about your project structure, recent changes, and ongoing work. This persistence is what makes it particularly effective for DevOps workflows where understanding the full state of a cluster, its manifests, and its history is essential.
  </p>

  <!-- Remote Connect -->
  <h2 id="remote-connect">Remote Connect</h2>
  <p class="text-text-secondary">
    Remote Connect (officially "Remote Control") is a feature that bridges a running Claude Code session to the web and mobile interfaces. When you start Remote Connect with <code>claude remote-control</code> or the <code>/remote-control</code> shortcut (also <code>/rc</code>) from within an active session, the session becomes accessible from <a href="https://claude.ai/code" class="text-accent hover:underline">claude.ai/code</a> or the Claude mobile app on iOS and Android.
  </p>
  <p class="text-text-secondary">
    The session itself keeps running on the original machine. The web and mobile clients are just a window into it -- they do not create a new session or spin up a separate process. This means all your local MCP servers, project configuration, environment variables, and tool access remain intact. You connect to the session via a generated URL, a QR code displayed in the terminal, or by selecting it from the session list in claude.ai/code.
  </p>
  <p class="text-text-secondary">
    Networking is outbound-only. The Claude Code process polls the Anthropic API for work over HTTPS -- no inbound ports need to be opened, no tunneling is required, and no firewall rules need to change. If the connection drops due to sleep or network interruption, it auto-reconnects when connectivity returns and times out after approximately 10 minutes offline.
  </p>
  <p class="text-text-secondary">
    A key distinction: Remote Connect runs on <strong>your</strong> machine (or your cluster, in RemoteKube's case) with your tools, your files, and your configuration. This is fundamentally different from Claude Code on the web, which runs in Anthropic's cloud with a sandboxed environment. Remote Connect currently requires a Max plan, with Pro plan support coming soon.
  </p>

  <!-- SVG Diagram 1: Remote Connect Architecture -->
  <DiagramBlock title="Remote Connect Architecture" description="How Remote Connect bridges a local Claude Code session to web and mobile clients.">
    <svg viewBox="0 0 800 300" class="w-full h-auto" role="img" aria-label="Remote Connect architecture diagram showing client devices connecting through Anthropic API to a local Claude Code process">
      <defs>
        <marker id="arrow-rc" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
          <polygon points="0 0, 10 3.5, 0 7" style="fill: oklch(0.70 0.15 250)" />
        </marker>
      </defs>

      <!-- Client Devices container (dashed) -->
      <rect x="20" y="30" width="220" height="190" rx="8" style="fill: none; stroke: oklch(0.28 0.04 260); stroke-width: 1.5; stroke-dasharray: 6 3" />
      <text x="130" y="54" text-anchor="middle" style="fill: oklch(0.55 0.02 260); font-size: 11px; font-weight: 600">Client Devices</text>

      <!-- Phone / Claude App -->
      <rect x="40" y="68" width="180" height="52" rx="8" style="fill: oklch(0.16 0.03 260 / 0.70); stroke: oklch(0.28 0.04 260); stroke-width: 1.5" />
      <text x="130" y="92" text-anchor="middle" style="fill: oklch(0.97 0.005 260); font-size: 13px; font-weight: 600">Phone / Claude App</text>
      <text x="130" y="108" text-anchor="middle" style="fill: oklch(0.55 0.02 260); font-size: 10px">iOS / Android</text>

      <!-- Browser / claude.ai/code -->
      <rect x="40" y="136" width="180" height="52" rx="8" style="fill: oklch(0.16 0.03 260 / 0.70); stroke: oklch(0.28 0.04 260); stroke-width: 1.5" />
      <text x="130" y="160" text-anchor="middle" style="fill: oklch(0.97 0.005 260); font-size: 13px; font-weight: 600">Browser</text>
      <text x="130" y="176" text-anchor="middle" style="fill: oklch(0.62 0.22 260); font-size: 10px; font-family: monospace">claude.ai/code</text>

      <!-- Anthropic API -->
      <rect x="310" y="88" width="180" height="72" rx="8" style="fill: oklch(0.16 0.03 260 / 0.70); stroke: oklch(0.28 0.04 260); stroke-width: 1.5" />
      <text x="400" y="118" text-anchor="middle" style="fill: oklch(0.97 0.005 260); font-size: 14px; font-weight: 600">Anthropic API</text>
      <text x="400" y="138" text-anchor="middle" style="fill: oklch(0.55 0.02 260); font-size: 10px">Polls for work</text>

      <!-- Claude Code Process -->
      <rect x="570" y="88" width="200" height="72" rx="8" style="fill: oklch(0.16 0.03 260 / 0.70); stroke: oklch(0.28 0.04 260); stroke-width: 1.5" />
      <text x="670" y="118" text-anchor="middle" style="fill: oklch(0.97 0.005 260); font-size: 14px; font-weight: 600">Claude Code Process</text>
      <text x="670" y="138" text-anchor="middle" style="fill: oklch(0.55 0.02 260); font-size: 10px">Running locally</text>

      <!-- Arrows: clients -> API -->
      <line x1="220" y1="94" x2="300" y2="112" style="stroke: oklch(0.70 0.15 250); stroke-width: 2" marker-end="url(#arrow-rc)" />
      <line x1="220" y1="162" x2="300" y2="136" style="stroke: oklch(0.70 0.15 250); stroke-width: 2" marker-end="url(#arrow-rc)" />

      <!-- Bidirectional arrows: API <-> Claude Code -->
      <line x1="490" y1="116" x2="560" y2="116" style="stroke: oklch(0.70 0.15 250); stroke-width: 2" marker-end="url(#arrow-rc)" />
      <line x1="570" y1="132" x2="500" y2="132" style="stroke: oklch(0.70 0.15 250); stroke-width: 2" marker-end="url(#arrow-rc)" />

      <!-- Note pill -->
      <rect x="210" y="256" width="380" height="28" rx="14" style="fill: oklch(0.14 0.03 260 / 0.60); stroke: oklch(0.24 0.04 260); stroke-width: 1" />
      <text x="400" y="274" text-anchor="middle" style="fill: oklch(0.55 0.02 260); font-size: 11px">Outbound HTTPS only -- no inbound ports required</text>
    </svg>
  </DiagramBlock>

  <!-- How RemoteKube Uses Remote Connect -->
  <h2 id="remotekube-integration">How RemoteKube Uses Remote Connect</h2>
  <p class="text-text-secondary">
    RemoteKube deploys Claude Code inside a Kubernetes pod as a persistent, long-lived process. The pod's entrypoint script (<code>entrypoint.sh</code>) starts Claude Code, and a PersistentVolumeClaim at <code>/app/.claude</code> persists credentials, settings, and skills across pod restarts. Inside the pod, Claude Code has full access to cluster tools -- <code>kubectl</code>, <code>helm</code>, <code>k9s</code>, <code>stern</code>, and 32+ other utilities installed in the container image.
  </p>
  <p class="text-text-secondary">
    Remote Connect turns this pod-hosted session into something you can access from anywhere. The pod's NetworkPolicy already permits outbound HTTPS on port 443, which is exactly what Remote Connect needs to poll the Anthropic API. No additional networking configuration is required -- the same egress rule that allows Claude Code to reach the Anthropic API for inference also enables Remote Connect.
  </p>
  <p class="text-text-secondary">
    This is the core value proposition: deploy once, control from anywhere. You set up the pod in your cluster with the tools, permissions, and workspace it needs. Then you connect from your phone on the go, your browser at your desk, or a tablet on the couch -- always reaching the same session with full cluster context, persistent history, and unchanged environment. There is no re-authentication with the cluster, no re-mounting of volumes, and no re-loading of project state.
  </p>

  <!-- SVG Diagram 2: RemoteKube + Remote Connect -->
  <DiagramBlock title="RemoteKube + Remote Connect" description="End-to-end flow from mobile/browser through Anthropic API to the Claude Code pod in Kubernetes.">
    <svg viewBox="0 0 800 380" class="w-full h-auto" role="img" aria-label="RemoteKube integration diagram showing phone and browser connecting through Anthropic API to a Claude Code pod inside a Kubernetes cluster">
      <defs>
        <marker id="arrow-rk" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
          <polygon points="0 0, 10 3.5, 0 7" style="fill: oklch(0.70 0.15 250)" />
        </marker>
      </defs>

      <!-- Top row: Client boxes -->
      <rect x="200" y="15" width="140" height="48" rx="8" style="fill: oklch(0.16 0.03 260 / 0.70); stroke: oklch(0.28 0.04 260); stroke-width: 1.5" />
      <text x="270" y="38" text-anchor="middle" style="fill: oklch(0.97 0.005 260); font-size: 13px; font-weight: 600">Phone</text>
      <text x="270" y="53" text-anchor="middle" style="fill: oklch(0.55 0.02 260); font-size: 10px">Claude App</text>

      <rect x="460" y="15" width="140" height="48" rx="8" style="fill: oklch(0.16 0.03 260 / 0.70); stroke: oklch(0.28 0.04 260); stroke-width: 1.5" />
      <text x="530" y="38" text-anchor="middle" style="fill: oklch(0.97 0.005 260); font-size: 13px; font-weight: 600">Browser</text>
      <text x="530" y="53" text-anchor="middle" style="fill: oklch(0.62 0.22 260); font-size: 10px; font-family: monospace">claude.ai/code</text>

      <!-- Middle: Anthropic API -->
      <rect x="310" y="96" width="180" height="52" rx="8" style="fill: oklch(0.16 0.03 260 / 0.70); stroke: oklch(0.28 0.04 260); stroke-width: 1.5" />
      <text x="400" y="120" text-anchor="middle" style="fill: oklch(0.97 0.005 260); font-size: 14px; font-weight: 600">Anthropic API</text>
      <text x="400" y="138" text-anchor="middle" style="fill: oklch(0.55 0.02 260); font-size: 10px">Relay / Bridge</text>

      <!-- Arrows: clients -> API -->
      <line x1="270" y1="63" x2="360" y2="88" style="stroke: oklch(0.70 0.15 250); stroke-width: 2" marker-end="url(#arrow-rk)" />
      <line x1="530" y1="63" x2="440" y2="88" style="stroke: oklch(0.70 0.15 250); stroke-width: 2" marker-end="url(#arrow-rk)" />

      <!-- Kubernetes Cluster container (dashed) -->
      <rect x="100" y="180" width="600" height="150" rx="10" style="fill: none; stroke: oklch(0.28 0.04 260); stroke-width: 1.5; stroke-dasharray: 6 3" />
      <text x="130" y="200" style="fill: oklch(0.55 0.02 260); font-size: 11px; font-weight: 600">Kubernetes Cluster</text>

      <!-- Pod box -->
      <rect x="130" y="212" width="360" height="100" rx="8" style="fill: oklch(0.16 0.03 260 / 0.70); stroke: oklch(0.28 0.04 260); stroke-width: 1.5" />
      <text x="310" y="234" text-anchor="middle" style="fill: oklch(0.97 0.005 260); font-size: 13px; font-weight: 600">claude-agent-0 Pod</text>

      <!-- Sub-elements inside pod -->
      <rect x="150" y="246" width="180" height="34" rx="6" style="fill: oklch(0.14 0.03 260 / 0.60); stroke: oklch(0.24 0.04 260); stroke-width: 1" />
      <text x="240" y="268" text-anchor="middle" style="fill: oklch(0.62 0.22 260); font-size: 11px; font-family: monospace">Claude Code Process</text>

      <rect x="340" y="246" width="130" height="34" rx="6" style="fill: oklch(0.14 0.03 260 / 0.60); stroke: oklch(0.24 0.04 260); stroke-width: 1" />
      <text x="405" y="260" text-anchor="middle" style="fill: oklch(0.55 0.02 260); font-size: 9px">PVC</text>
      <text x="405" y="274" text-anchor="middle" style="fill: oklch(0.62 0.22 260); font-size: 9px; font-family: monospace">/app/.claude</text>

      <!-- NetworkPolicy box -->
      <rect x="530" y="226" width="150" height="60" rx="8" style="fill: oklch(0.16 0.03 260 / 0.70); stroke: oklch(0.28 0.04 260); stroke-width: 1.5" />
      <text x="605" y="250" text-anchor="middle" style="fill: oklch(0.97 0.005 260); font-size: 12px; font-weight: 600">NetworkPolicy</text>
      <text x="605" y="268" text-anchor="middle" style="fill: oklch(0.55 0.02 260); font-size: 10px">Egress: 443 (HTTPS)</text>

      <!-- Arrow: API <-> Pod (bidirectional, through cluster boundary) -->
      <line x1="380" y1="148" x2="320" y2="172" style="stroke: oklch(0.70 0.15 250); stroke-width: 2" marker-end="url(#arrow-rk)" />
      <line x1="310" y1="180" x2="390" y2="153" style="stroke: oklch(0.70 0.15 250); stroke-width: 2" marker-end="url(#arrow-rk)" />

      <!-- Note pill -->
      <rect x="250" y="344" width="300" height="28" rx="14" style="fill: oklch(0.14 0.03 260 / 0.60); stroke: oklch(0.24 0.04 260); stroke-width: 1" />
      <text x="400" y="362" text-anchor="middle" style="fill: oklch(0.55 0.02 260); font-size: 11px">Deploy once, control from anywhere</text>
    </svg>
  </DiagramBlock>

  <!-- Key Differences -->
  <h2 id="key-differences">Key Differences</h2>
  <p class="text-text-secondary">
    Remote Connect through RemoteKube and Claude Code on the web both let you interact with Claude Code from a browser, but the underlying architecture is fundamentally different.
  </p>

  <div class="docs-table">
    <table>
      <thead>
        <tr>
          <th>Feature</th>
          <th>Remote Connect (RemoteKube)</th>
          <th>Claude Code on Web</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Runs on</td>
          <td>Your Kubernetes cluster</td>
          <td>Anthropic cloud</td>
        </tr>
        <tr>
          <td>Tools access</td>
          <td>Full cluster tools (kubectl, helm, etc.)</td>
          <td>Sandboxed environment</td>
        </tr>
        <tr>
          <td>Project files</td>
          <td>PVC-backed persistent workspace</td>
          <td>Cloud workspace</td>
        </tr>
        <tr>
          <td>MCP servers</td>
          <td>Custom MCP configurations</td>
          <td>Standard only</td>
        </tr>
        <tr>
          <td>Session persistence</td>
          <td>Survives pod restarts (PVC)</td>
          <td>Cloud-managed</td>
        </tr>
        <tr>
          <td>Network</td>
          <td>Your cluster network + policies</td>
          <td>Anthropic network</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Getting Started -->
  <h2 id="getting-started">Getting Started</h2>
  <p class="text-text-secondary">
    Once your RemoteKube pod is running, start Remote Connect from inside the Claude Code session.
  </p>

  <p class="text-text-secondary text-sm mt-4">
    <strong>Note:</strong> Remote Control currently works on macOS only. Linux support is pending a server-side feature gate from Anthropic.
  </p>

  <TerminalBlock title="Start Remote Connect" commands={["claude remote-control"]} />

  <p class="text-text-secondary mt-4">
    Or, if you are already inside a Claude Code session, use the shortcut command.
  </p>

  <TerminalBlock title="Shortcut from within a session" commands={["/remote-control"]} />

  <p class="text-text-secondary mt-4">
    After starting Remote Connect, scan the QR code displayed in the terminal or visit the generated session URL from your phone or browser. You can also find active sessions in the session list at <a href="https://claude.ai/code" class="text-accent hover:underline">claude.ai/code</a>.
  </p>
  <p class="text-text-secondary">
    Remote Connect currently requires a <strong>Max plan</strong>. Pro plan support is coming soon.
  </p>
</DocsLayout>
